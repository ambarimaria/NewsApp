@model NewsApp.Models.ViewModels.PaginationInfo
@{
    // Route values are passed via ViewData so this partial stays generic
    var routeValues = ViewData["PaginationRouteValues"] as Dictionary<string, string?> ?? new();
    var action = ViewData["PaginationAction"]?.ToString() ?? "Index";
    var controller = ViewData["PaginationController"]?.ToString() ?? "News";

    int windowStart = Math.Max(1, Model.CurrentPage - 2);
    int windowEnd   = Math.Min(Model.TotalPages, Model.CurrentPage + 2);
}

@if (Model.TotalPages > 1)
{
    <nav aria-label="Page navigation" class="mt-4">
        <ul class="pagination pagination-dark justify-content-center flex-wrap gap-1 mb-0">

            <!-- First -->
            @if (Model.CurrentPage > 3)
            {
                var rv = new Dictionary<string, string?>(routeValues) { ["page"] = "1" };
                <li class="page-item">
                    <a class="page-link" asp-controller="@controller" asp-action="@action"
                       asp-all-route-data="@rv">
                        <i class="fas fa-angles-left"></i>
                    </a>
                </li>
            }

            <!-- Previous -->
            @if (Model.HasPrevious)
            {
                var rv = new Dictionary<string, string?>(routeValues) { ["page"] = (Model.CurrentPage - 1).ToString() };
                <li class="page-item">
                    <a class="page-link" asp-controller="@controller" asp-action="@action"
                       asp-all-route-data="@rv">
                        <i class="fas fa-chevron-left"></i>
                    </a>
                </li>
            }

            <!-- Page numbers -->
            @for (int p = windowStart; p <= windowEnd; p++)
            {
                var rv = new Dictionary<string, string?>(routeValues) { ["page"] = p.ToString() };
                <li class="page-item @(p == Model.CurrentPage ? "active" : "")">
                    <a class="page-link" asp-controller="@controller" asp-action="@action"
                       asp-all-route-data="@rv">@p</a>
                </li>
            }

            <!-- Next -->
            @if (Model.HasNext)
            {
                var rv = new Dictionary<string, string?>(routeValues) { ["page"] = (Model.CurrentPage + 1).ToString() };
                <li class="page-item">
                    <a class="page-link" asp-controller="@controller" asp-action="@action"
                       asp-all-route-data="@rv">
                        <i class="fas fa-chevron-right"></i>
                    </a>
                </li>
            }

            <!-- Last -->
            @if (Model.CurrentPage < Model.TotalPages - 2)
            {
                var rv = new Dictionary<string, string?>(routeValues) { ["page"] = Model.TotalPages.ToString() };
                <li class="page-item">
                    <a class="page-link" asp-controller="@controller" asp-action="@action"
                       asp-all-route-data="@rv">
                        <i class="fas fa-angles-right"></i>
                    </a>
                </li>
            }
        </ul>

        <p class="text-center text-secondary small mt-2">
            Showing @Model.StartIndex–@Model.EndIndex of @Model.TotalResults.ToString("N0") articles
        </p>
    </nav>
}

